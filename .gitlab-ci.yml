test_docu:
  image: python:2.7
  stage: test

  variables:
    TEST_ARG: "make test-experiment-setup test-autogenerated-files"
    CI_DEBUG_TRACE: "true"

  before_script:
    - if [[ "$TEST_ARG" == *test-dymola* ]]; then
         docker login -u $CI_DEPLOY_USER -p $CI_DEPLOY_PASSWORD registry.git.rwth-aachen.de && docker pull registry.git.rwth-aachen.de/ebc/ebc_intern/dymola-docker:tag;
         chmod +x Buildings/Resources/Scripts/travis/bin/dymola;
         cp Buildings/Resources/Scripts/travis/bin/dymola $HOME/bin/;
      fi;
    - apt-get -qq update
    - apt-get -qq install -y tidy
    - export PYTHONIOENCODING=UTF8 # just in case
    - pip install --upgrade pip setuptools wheel
    - pip install --only-binary=numpy,scipy,matplotlib numpy scipy matplotlib
    - pip install git+https://github.com/lbl-srg/BuildingsPy@master

  script:
    - (cd AixLib/Resources/Scripts/travis && $TEST_ARG)

test_Air:
  image: python:2.7
  stage: test

  variables:
    TEST_ARG: "make test-dymola PACKAGE=\"AixLib.{Air,Examples}\""
    CI_DEBUG_TRACE: "true"

  before_script:
    - if [[ "$TEST_ARG" == *test-dymola* ]]; then
         docker login -u $CI_DEPLOY_USER -p $CI_DEPLOY_PASSWORD registry.git.rwth-aachen.de && docker pull registry.git.rwth-aachen.de/ebc/ebc_intern/dymola-docker:tag;
         chmod +x AixLib/Resources/Scripts/travis/bin/dymola;
         sudo cp AixLib/Resources/Scripts/travis/bin/dymola $HOME/bin/;
      fi;
    - apt-get -qq update
    - apt-get -qq install -y tidy
    - export PYTHONIOENCODING=UTF8 # just in case
    - pip install --upgrade pip setuptools wheel
    - pip install --only-binary=numpy,scipy,matplotlib numpy scipy matplotlib
    - pip install git+https://github.com/lbl-srg/BuildingsPy@master

  script:
    - (cd AixLib/Resources/Scripts/travis && $TEST_ARG)